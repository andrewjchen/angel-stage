#! /usr/bin/env python3
# encoding: utf-8

def options(opt):
    pass

def configure(conf):
    pass

from os.path import join
def build(bld):
    sdl_libs = ['SDL', 'SDL_image']
    allegro_libs = ['allegro', 'allegro_image']
    common_includes = ['.',
                       join(bld.top_dir, 'include'),
                       join(bld.top_dir, 'deps', 'usr', 'local', 'include'),
                       join(bld.top_dir, 'include', 'shared')]
    common_libpath = [join(bld.top_dir, 'deps', 'usr', 'local', 'lib')]
    client_includes = common_includes + [join(bld.top_dir, 'include', 'client')]
    server_includes = common_includes + [join(bld.top_dir, 'include', 'server')]
    common_lib = ['boost_system', 'boost_thread','SDL_net']
    bld.stlib(
        source = bld.path.ant_glob('shared/*.cxx'),
        includes = common_includes,
        target = 'angel-stage-shared-lib',
        )
    bld.stlib(
        source = bld.path.ant_glob('server/*.cxx'),
        includes = server_includes,
        use = 'angel-stage-shared-lib',
        target = 'angel-stage-server-lib',
        )
    bld.stlib(
        source = bld.path.ant_glob('client/*.cxx'),
        includes = client_includes,
        use = 'angel-stage-shared-lib',
        target = 'angel-stage-client-lib',
        )
    bld.program(
                source = 'allegro_main.c', 
                target = 'allegro_main', 
                lib = allegro_libs, 
                libpath = common_libpath,
                includes = common_includes, 
                )
    bld.program(
                source = 'sdl_main.c', 
                target = 'sdl_main', 
                lib = sdl_libs,
                lib_path = common_libpath,
                includes = common_includes, 
                )
    bld.program(
                source = 'sdl_main.cxx', 
                target = 'sdl_main_cxx', 
                lib = sdl_libs,
                lib_path = common_libpath,
                includes = common_includes, 
                )
    bld.program(
        source = 'client_main.cxx',
        target = 'client_main',
        includes = client_includes,
        lib = common_lib + allegro_libs,
        use = ['angel-stage-shared-lib', 'angel-stage-client-lib'],
        )
    bld.program(
        source = 'server_main.cxx',
        target = 'server_main',
        includes = server_includes,
        lib = common_lib + sdl_libs,
        use = ['angel-stage-shared-lib', 'angel-stage-server-lib'],
        )
